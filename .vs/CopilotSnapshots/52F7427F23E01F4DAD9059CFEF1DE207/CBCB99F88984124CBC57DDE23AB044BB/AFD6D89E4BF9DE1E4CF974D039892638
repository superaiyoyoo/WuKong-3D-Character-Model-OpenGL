#include <Windows.h>
#include <gl/GL.h>
#include <gl/GLU.h>
#include <math.h>

#pragma comment (lib, "OpenGL32.lib")
#pragma comment (lib, "GLU32.lib")

#define WINDOW_TITLE "Traditional Character with Heritage Boots"
#define PI 3.14159265359

// Global variables for camera control
float rotationX = 10.0f;  // Adjusted for better character viewing
float rotationY = 0.0f;   // Start with front view
float zoom = -12.0f;      // Pulled back to see full character

// Function to draw treaded sole pattern
void drawTreadedSole() {
    glDisable(GL_LIGHTING);
    glLineWidth(2.0f);
    glColor3f(0.1f, 0.08f, 0.06f); // Very dark brown for treads
    
    // Draw horizontal tread lines
    for (int i = 0; i < 8; i++) {
        float z = -1.0f + (i * 0.25f);
        glBegin(GL_LINES);
        for (int j = 0; j < 6; j++) {
            float x = -0.3f + (j * 0.12f);
            glVertex3f(x, -0.82f, z);
            glVertex3f(x + 0.08f, -0.82f, z);
        }
        glEnd();
    }
    
    // Draw diagonal tread pattern
    for (int i = 0; i < 12; i++) {
        float z = -1.0f + (i * 0.15f);
        glBegin(GL_LINES);
        glVertex3f(-0.35f, -0.82f, z);
        glVertex3f(0.35f, -0.82f, z + 0.1f);
        glEnd();
    }
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw reinforced toe cap
void drawReinforcedToeCap() {
    GLfloat reinforcementColor[] = { 0.3f, 0.2f, 0.15f, 1.0f }; // Darker protective material
    glColor3fv(reinforcementColor);
    
    glPushMatrix();
    glTranslatef(0.0f, -0.15f, 0.7f);
    glScalef(0.65f, 0.4f, 0.6f);
    GLUquadric* toeCap = gluNewQuadric();
    gluSphere(toeCap, 0.5, 16, 16);
    gluDeleteQuadric(toeCap);
    glPopMatrix();
    
    // Add toe cap stitching
    glDisable(GL_LIGHTING);
    glColor3f(0.7f, 0.6f, 0.4f); // Tan stitching
    glLineWidth(2.5f);
    glBegin(GL_LINE_LOOP);
    for (int i = 0; i <= 15; i++) {
        float angle = (i - 7.5f) * 0.12f;
        float x = sinf(angle) * 0.4f;
        float y = -0.05f;
        float z = cosf(angle) * 0.25f + 0.5f;
        glVertex3f(x, y, z);
    }
    glEnd();
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw speed hooks for quick lacing
void drawSpeedHooks() {
    GLfloat metalColor[] = { 0.7f, 0.7f, 0.7f, 1.0f }; // Metallic color
    glColor3fv(metalColor);
    
    for (int i = 0; i < 3; i++) {
        float y = 1.4f + i * 0.2f;
        
        // Left speed hook
        glPushMatrix();
        glTranslatef(-0.18f, y, 0.35f);
        glRotatef(90, 0, 1, 0);
        glScalef(0.02f, 0.08f, 0.02f);
        GLUquadric* leftHook = gluNewQuadric();
        gluCylinder(leftHook, 1.0f, 1.0f, 1.0f, 8, 1);
        gluDeleteQuadric(leftHook);
        glPopMatrix();
        
        // Right speed hook
        glPushMatrix();
        glTranslatef(0.18f, y, 0.35f);
        glRotatef(90, 0, 1, 0);
        glScalef(0.02f, 0.08f, 0.02f);
        GLUquadric* rightHook = gluNewQuadric();
        gluCylinder(rightHook, 1.0f, 1.0f, 1.0f, 8, 1);
        gluDeleteQuadric(rightHook);
        glPopMatrix();
    }
}

// Function to draw pull tab at the back
void drawPullTab() {
    GLfloat tabColor[] = { 0.4f, 0.25f, 0.15f, 1.0f }; // Darker leather for tab
    glColor3fv(tabColor);
    
    glPushMatrix();
    glTranslatef(0.0f, 2.0f, -0.45f);
    glScalef(0.15f, 0.25f, 0.08f);
    GLUquadric* tab = gluNewQuadric();
    gluSphere(tab, 0.5, 12, 12);
    gluDeleteQuadric(tab);
    glPopMatrix();
    
    // Add tab stitching
    glDisable(GL_LIGHTING);
    glColor3f(0.7f, 0.6f, 0.4f);
    glLineWidth(2.0f);
    glBegin(GL_LINE_LOOP);
    glVertex3f(-0.06f, 2.1f, -0.42f);
    glVertex3f(0.06f, 2.1f, -0.42f);
    glVertex3f(0.06f, 1.9f, -0.42f);
    glVertex3f(-0.06f, 1.9f, -0.42f);
    glEnd();
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw protective heel counter
void drawHeelCounter() {
    GLfloat counterColor[] = { 0.35f, 0.22f, 0.16f, 1.0f }; // Protective material
    glColor3fv(counterColor);
    
    glPushMatrix();
    glTranslatef(0.0f, 0.1f, -0.7f);
    glScalef(0.6f, 0.8f, 0.5f);
    GLUquadric* counter = gluNewQuadric();
    gluSphere(counter, 0.5, 16, 16);
    gluDeleteQuadric(counter);
    glPopMatrix();
}

// Function to draw ventilation grommets
void drawVentilationGrommets() {
    GLfloat grommetColor[] = { 0.2f, 0.2f, 0.2f, 1.0f }; // Dark metal
    glColor3fv(grommetColor);
    
    // Side ventilation grommets
    for (int i = 0; i < 3; i++) {
        float y = 0.6f + i * 0.3f;
        
        // Left side grommets
        glPushMatrix();
        glTranslatef(-0.4f, y, 0.1f);
        glScalef(0.025f, 0.025f, 0.025f);
        GLUquadric* leftGrommet = gluNewQuadric();
        gluSphere(leftGrommet, 1.0f, 8, 8);
        gluDeleteQuadric(leftGrommet);
        glPopMatrix();
        
        // Right side grommets
        glPushMatrix();
        glTranslatef(0.4f, y, 0.1f);
        glScalef(0.025f, 0.025f, 0.025f);
        GLUquadric* rightGrommet = gluNewQuadric();
        gluSphere(rightGrommet, 1.0f, 8, 8);
        gluDeleteQuadric(rightGrommet);
        glPopMatrix();
    }
}

// Function to draw ankle support padding
void drawAnkleSupport() {
    GLfloat paddingColor[] = { 0.45f, 0.28f, 0.18f, 1.0f }; // Padded material
    glColor3fv(paddingColor);
    
    // Inner ankle padding
    glPushMatrix();
    glTranslatef(-0.25f, 0.8f, -0.1f);
    glScalef(0.12f, 0.4f, 0.3f);
    GLUquadric* innerPadding = gluNewQuadric();
    gluSphere(innerPadding, 0.5, 12, 12);
    gluDeleteQuadric(innerPadding);
    glPopMatrix();
    
    // Outer ankle padding
    glPushMatrix();
    glTranslatef(0.25f, 0.8f, -0.1f);
    glScalef(0.12f, 0.4f, 0.3f);
    GLUquadric* outerPadding = gluNewQuadric();
    gluSphere(outerPadding, 0.5, 12, 12);
    gluDeleteQuadric(outerPadding);
    glPopMatrix();
}

// Enhanced utility function to draw a curved boot shaft
void drawCurvedBootShaft(float height, float bottomRadius, float topRadius) {
    int segments = 20;
    float angleStep = 2.0f * PI / segments;
    
    glBegin(GL_TRIANGLE_STRIP);
    for (int i = 0; i <= segments; i++) {
        float angle = i * angleStep;
        float x = cosf(angle);
        float z = sinf(angle);
        
        // Bottom vertex
        glNormal3f(x, 0, z);
        glVertex3f(x * bottomRadius, 0, z * bottomRadius);
        
        // Top vertex (slightly tapered and curved)
        float topX = x * topRadius;
        float topZ = z * topRadius * 0.9f; // Slightly flatten the back
        glNormal3f(x, 0, z);
        glVertex3f(topX, height, topZ);
    }
    glEnd();
    
    // Draw top cap
    glBegin(GL_TRIANGLE_FAN);
    glNormal3f(0, 1, 0);
    glVertex3f(0, height, 0); // Center point
    for (int i = 0; i <= segments; i++) {
        float angle = i * angleStep;
        float x = cosf(angle) * topRadius;
        float z = sinf(angle) * topRadius * 0.9f;
        glVertex3f(x, height, z);
    }
    glEnd();
}

// Enhanced function to draw organic foot shape
void drawOrganicFootShape() {
    // Draw the main foot body using multiple scaled spheres for organic shape
    glPushMatrix();
    // Toe area
    glTranslatef(0.0f, 0.0f, 0.6f);
    glScalef(0.6f, 0.5f, 0.8f);
    GLUquadric* toe = gluNewQuadric();
    gluSphere(toe, 0.5, 16, 16);
    gluDeleteQuadric(toe);
    glPopMatrix();
    
    // Mid foot
    glPushMatrix();
    glTranslatef(0.0f, 0.0f, 0.0f);
    glScalef(0.7f, 0.6f, 1.0f);
    GLUquadric* mid = gluNewQuadric();
    gluSphere(mid, 0.5, 16, 16);
    gluDeleteQuadric(mid);
    glPopMatrix();
    
    // Heel area
    glPushMatrix();
    glTranslatef(0.0f, 0.0f, -0.6f);
    glScalef(0.65f, 0.55f, 0.7f);
    GLUquadric* heel = gluNewQuadric();
    gluSphere(heel, 0.5, 16, 16);
    gluDeleteQuadric(heel);
    glPopMatrix();
}

// Enhanced traditional decorative stitching with tactical elements
void drawTacticalStitching() {
    glDisable(GL_LIGHTING);
    glLineWidth(2.5f);
    
    // Reinforcement stitching around high-stress areas
    glColor3f(0.8f, 0.7f, 0.5f); // Tactical tan stitching
    
    // Side panel reinforcement stitching
    glBegin(GL_LINE_STRIP);
    glVertex3f(-0.45f, -0.1f, 0.5f);
    glVertex3f(-0.5f, 0.1f, 0.2f);
    glVertex3f(-0.45f, 0.3f, -0.1f);
    glVertex3f(-0.4f, 0.5f, -0.3f);
    glVertex3f(-0.35f, 0.8f, -0.4f);
    glEnd();
    
    glBegin(GL_LINE_STRIP);
    glVertex3f(0.45f, -0.1f, 0.5f);
    glVertex3f(0.5f, 0.1f, 0.2f);
    glVertex3f(0.45f, 0.3f, -0.1f);
    glVertex3f(0.4f, 0.5f, -0.3f);
    glVertex3f(0.35f, 0.8f, -0.4f);
    glEnd();
    
    // Central reinforcement seam
    glBegin(GL_LINE_STRIP);
    glVertex3f(0.0f, 0.3f, 0.6f);
    glVertex3f(0.0f, 0.5f, 0.3f);
    glVertex3f(0.0f, 0.7f, 0.0f);
    glVertex3f(0.0f, 1.0f, -0.2f);
    glVertex3f(0.0f, 1.5f, -0.3f);
    glEnd();
    
    // Heel reinforcement stitching
    glBegin(GL_LINE_LOOP);
    for (int i = 0; i <= 10; i++) {
        float angle = i * PI / 10.0f;
        float x = sinf(angle) * 0.3f;
        float y = 0.2f + cosf(angle) * 0.2f;
        float z = -0.6f;
        glVertex3f(x, y, z);
    }
    glEnd();
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Main function to draw an enhanced combat boot
void drawCombatBoot(bool isLeft) {
    // Tactical earth-tone colors
    GLfloat soleColor[] = { 0.2f, 0.12f, 0.08f, 1.0f };        // Dark brown sole
    GLfloat leatherColor[] = { 0.45f, 0.32f, 0.2f, 1.0f };     // Tactical brown leather
    GLfloat darkerLeather[] = { 0.35f, 0.22f, 0.15f, 1.0f };   // Darker tactical brown
    GLfloat stitchColor[] = { 0.8f, 0.7f, 0.5f, 1.0f };        // Tactical tan stitching
    
    glPushMatrix(); // Start of boot matrix

    // Mirror the boot if it's the right one
    if (!isLeft) {
        glScalef(-1.0f, 1.0f, 1.0f);
    }

    // --- Enhanced Tactical Sole (thicker and more rugged) ---
    glColor3fv(soleColor);
    glPushMatrix();
    glTranslatef(0.0f, -0.8f, 0.1f);
    glScalef(0.8f, 0.12f, 2.4f); // Thicker sole
    GLUquadric* sole = gluNewQuadric();
    gluSphere(sole, 0.5, 20, 20);
    gluDeleteQuadric(sole);
    glPopMatrix();

    // Add treaded sole pattern
    drawTreadedSole();

    // --- Enhanced Military Heel ---
    glColor3fv(soleColor);
    glPushMatrix();
    glTranslatef(0.0f, -0.6f, -0.8f);
    glScalef(0.55f, 0.35f, 0.45f); // Slightly larger and more robust
    GLUquadric* heel = gluNewQuadric();
    gluSphere(heel, 0.5, 12, 12);
    gluDeleteQuadric(heel);
    glPopMatrix();

    // --- Main Foot Body (Enhanced Organic Shape) ---
    glColor3fv(leatherColor);
    glPushMatrix();
    glTranslatef(0.0f, -0.25f, 0.2f);
    drawOrganicFootShape();
    glPopMatrix();

    // --- Reinforced Toe Cap ---
    drawReinforcedToeCap();

    // --- Enhanced Combat Boot Shaft ---
    glColor3fv(leatherColor);
    glPushMatrix();
    glTranslatef(0.0f, 0.45f, -0.3f);
    drawCurvedBootShaft(1.9f, 0.52f, 0.44f); // Slightly taller and more tapered
    glPopMatrix();

    // --- Heel Counter Protection ---
    drawHeelCounter();

    // --- Enhanced Ankle Support ---
    drawAnkleSupport();

    // --- Tactical Cuff ---
    glColor3fv(darkerLeather);
    glPushMatrix();
    glTranslatef(0.0f, 2.2f, -0.3f);
    glScalef(0.47f, 0.18f, 0.47f);
    GLUquadric* cuff = gluNewQuadric();
    gluSphere(cuff, 1.0f, 16, 16);
    gluDeleteQuadric(cuff);
    glPopMatrix();

    // --- Pull Tab ---
    drawPullTab();

    // --- Gusseted Tongue (Waterproof) ---
    glColor3fv(leatherColor);
    glPushMatrix();
    glTranslatef(0.0f, 0.25f, 0.65f);
    glRotatef(-8, 1, 0, 0);
    glScalef(0.32f, 0.06f, 0.85f);
    GLUquadric* tongue = gluNewQuadric();
    gluSphere(tongue, 0.5, 12, 12);
    gluDeleteQuadric(tongue);
    glPopMatrix();

    // --- Enhanced Side Reinforcement Panels ---
    glColor3fv(darkerLeather);
    // Left reinforced panel
    glPushMatrix();
    glTranslatef(-0.37f, 0.35f, 0.0f);
    glScalef(0.12f, 0.9f, 0.65f);
    GLUquadric* leftPanel = gluNewQuadric();
    gluSphere(leftPanel, 0.5, 12, 12);
    gluDeleteQuadric(leftPanel);
    glPopMatrix();
    
    // Right reinforced panel
    glPushMatrix();
    glTranslatef(0.37f, 0.35f, 0.0f);
    glScalef(0.12f, 0.9f, 0.65f);
    GLUquadric* rightPanel = gluNewQuadric();
    gluSphere(rightPanel, 0.5, 12, 12);
    gluDeleteQuadric(rightPanel);
    glPopMatrix();

    // --- Ventilation Grommets ---
    drawVentilationGrommets();

    // --- Enhanced Tactical Stitching ---
    glColor3fv(stitchColor);
    drawTacticalStitching();

    // --- Combat Boot Lacing System ---
    glColor3fv(darkerLeather);
    
    // Regular eyelets (bottom section)
    for (int i = 0; i < 5; i++) {
        float y = 0.4f + i * 0.2f;
        
        // Left eyelet
        glPushMatrix();
        glTranslatef(-0.16f, y, 0.42f);
        glScalef(0.035f, 0.035f, 0.035f);
        GLUquadric* eyelet1 = gluNewQuadric();
        gluSphere(eyelet1, 1.0f, 8, 8);
        gluDeleteQuadric(eyelet1);
        glPopMatrix();
        
        // Right eyelet
        glPushMatrix();
        glTranslatef(0.16f, y, 0.42f);
        glScalef(0.035f, 0.035f, 0.035f);
        GLUquadric* eyelet2 = gluNewQuadric();
        gluSphere(eyelet2, 1.0f, 8, 8);
        gluDeleteQuadric(eyelet2);
        glPopMatrix();
    }

    // --- Speed Hooks (upper section) ---
    drawSpeedHooks();

    // --- Enhanced Combat Lacing ---
    glDisable(GL_LIGHTING);
    glColor3f(0.25f, 0.15f, 0.1f); // Dark tactical brown lacing
    glLineWidth(4.0f);
    
    // Standard lacing pattern (eyelets)
    for (int i = 0; i < 4; i++) {
        float y1 = 0.4f + i * 0.2f;
        float y2 = 0.4f + (i + 1) * 0.2f;
        
        glBegin(GL_LINES);
        glVertex3f(-0.16f, y1, 0.43f);
        glVertex3f(0.16f, y2, 0.43f);
        glVertex3f(0.16f, y1, 0.43f);
        glVertex3f(-0.16f, y2, 0.43f);
        glEnd();
    }
    
    // Speed hook lacing pattern
    for (int i = 0; i < 2; i++) {
        float y1 = 1.4f + i * 0.2f;
        float y2 = 1.4f + (i + 1) * 0.2f;
        
        glBegin(GL_LINES);
        glVertex3f(-0.18f, y1, 0.36f);
        glVertex3f(0.18f, y2, 0.36f);
        glVertex3f(0.18f, y1, 0.36f);
        glVertex3f(-0.18f, y2, 0.36f);
        glEnd();
    }
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);

    glPopMatrix(); // End of boot matrix
}

// Function to draw sole welt (traditional boot construction)
void drawSoleWelt() {
    GLfloat weltColor[] = { 0.4f, 0.25f, 0.15f, 1.0f }; // Darker leather welt
    glColor3fv(weltColor);
    
    // Draw the welt strip around the boot
    glPushMatrix();
    glTranslatef(0.0f, -0.68f, 0.1f);
    glRotatef(90, 1, 0, 0);
    glScalef(0.82f, 2.5f, 0.05f);
    GLUquadric* welt = gluNewQuadric();
    gluCylinder(welt, 0.5, 0.5, 1.0, 24, 1);
    gluDeleteQuadric(welt);
    glPopMatrix();
    
    // Add welt stitching
    glDisable(GL_LIGHTING);
    glColor3f(0.9f, 0.8f, 0.6f); // Light tan welt stitching
    glLineWidth(2.0f);
    
    // Draw stitching around the welt
    glBegin(GL_LINE_LOOP);
    for (int i = 0; i <= 30; i++) {
        float angle = i * 2.0f * PI / 30.0f;
        float x = cosf(angle) * 0.42f;
        float z = sinf(angle) * 1.2f;
        glVertex3f(x, -0.67f, z + 0.1f);
    }
    glEnd();
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw eyelet reinforcement rings
void drawEyeletRings() {
    GLfloat ringColor[] = { 0.6f, 0.6f, 0.6f, 1.0f }; // Brushed metal
    glColor3fv(ringColor);
    
    for (int i = 0; i < 5; i++) {
        float y = 0.4f + i * 0.2f;
        
        // Left eyelet ring
        glPushMatrix();
        glTranslatef(-0.16f, y, 0.42f);
        glRotatef(90, 0, 1, 0);
        glScalef(0.025f, 0.025f, 0.01f);
        GLUquadric* leftRing = gluNewQuadric();
        gluCylinder(leftRing, 1.0f, 1.0f, 1.0f, 12, 1);
        gluDeleteQuadric(leftRing);
        glPopMatrix();
        
        // Right eyelet ring
        glPushMatrix();
        glTranslatef(0.16f, y, 0.42f);
        glRotatef(90, 0, 1, 0);
        glScalef(0.025f, 0.025f, 0.01f);
        GLUquadric* rightRing = gluNewQuadric();
        gluCylinder(rightRing, 1.0f, 1.0f, 1.0f, 12, 1);
        gluDeleteQuadric(rightRing);
        glPopMatrix();
    }
}

// Function to draw brogue detailing (decorative perforations)
void drawBrogueDetailing() {
    GLfloat brogueColor[] = { 0.3f, 0.18f, 0.12f, 1.0f }; // Dark accent color
    glColor3fv(brogueColor);
    
    // Toe cap brogue perforations
    for (int i = 0; i < 12; i++) {
        float angle = (i - 6) * 0.1f;
        float x = sinf(angle) * 0.35f;
        float z = cosf(angle) * 0.2f + 0.45f;
        
        glPushMatrix();
        glTranslatef(x, -0.08f, z);
        glScalef(0.015f, 0.015f, 0.015f);
        GLUquadric* perforation = gluNewQuadric();
        gluSphere(perforation, 1.0f, 6, 6);
        gluDeleteQuadric(perforation);
        glPopMatrix();
    }
    
    // Side panel brogue detailing
    for (int side = -1; side <= 1; side += 2) {
        for (int i = 0; i < 8; i++) {
            float y = 0.1f + i * 0.15f;
            
            glPushMatrix();
            glTranslatef(side * 0.42f, y, 0.1f);
            glScalef(0.012f, 0.012f, 0.012f);
            GLUquadric* sidePerforation = gluNewQuadric();
            gluSphere(sidePerforation, 1.0f, 6, 6);
            gluDeleteQuadric(sidePerforation);
            glPopMatrix();
        }
    }
}

// Function to draw classic cap toe seam
void drawCapToeSeam() {
    glDisable(GL_LIGHTING);
    glColor3f(0.85f, 0.75f, 0.55f); // Prominent stitching color
    glLineWidth(3.0f);
    
    // Classic cap toe seam line
    glBegin(GL_LINE_STRIP);
    for (int i = 0; i <= 20; i++) {
        float angle = (i - 10) * 0.12f;
        float x = sinf(angle) * 0.45f;
        float y = -0.08f;
        float z = cosf(angle) * 0.22f + 0.4f;
        glVertex3f(x, y, z);
    }
    glEnd();
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw multiple rows of stitching for durability
void drawDoubleTripleStitching() {
    glDisable(GL_LIGHTING);
    glColor3f(0.8f, 0.7f, 0.5f);
    glLineWidth(2.0f);
    
    // Double stitching on side panels
    for (int side = -1; side <= 1; side += 2) {
        for (int row = 0; row < 2; row++) {
            float offset = (row - 0.5f) * 0.02f;
            
            glBegin(GL_LINE_STRIP);
            glVertex3f(side * (0.45f + offset), -0.1f, 0.5f);
            glVertex3f(side * (0.5f + offset), 0.1f, 0.2f);
            glVertex3f(side * (0.45f + offset), 0.3f, -0.1f);
            glVertex3f(side * (0.4f + offset), 0.5f, -0.3f);
            glVertex3f(side * (0.35f + offset), 0.8f, -0.4f);
            glEnd();
        }
    }
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to simulate leather grain texture
void drawLeatherGrainTexture() {
    glDisable(GL_LIGHTING);
    glPointSize(1.0f);
    glColor3f(0.4f, 0.28f, 0.18f); // Slightly darker for texture
    
    glBegin(GL_POINTS);
    
    // Random grain pattern on the main boot surface
    for (int i = 0; i < 150; i++) {
        float x = ((i * 13) % 100 - 50) * 0.008f; // Pseudo-random pattern
        float y = ((i * 17) % 200 - 50) * 0.008f;
        float z = ((i * 23) % 150 - 50) * 0.008f;
        
        // Only draw points on visible surfaces
        if (x*x + z*z < 0.4f && y > -0.4f && y < 1.8f) {
            glVertex3f(x, y, z);
        }
    }
    
    glEnd();
    glPointSize(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to add subtle patina/wear effects
void drawPatinaEffects() {
    GLfloat patinaColor[] = { 0.38f, 0.25f, 0.16f, 0.7f }; // Slightly darker worn areas
    glColor4fv(patinaColor);
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    
    // Toe scuff mark
    glPushMatrix();
    glTranslatef(0.0f, -0.2f, 0.8f);
    glScalef(0.4f, 0.1f, 0.3f);
    GLUquadric* toeScuff = gluNewQuadric();
    gluSphere(toeScuff, 0.5, 12, 12);
    gluDeleteQuadric(toeScuff);
    glPopMatrix();
    
    // Heel wear
    glPushMatrix();
    glTranslatef(0.0f, -0.1f, -0.7f);
    glScalef(0.3f, 0.15f, 0.25f);
    GLUquadric* heelWear = gluNewQuadric();
    gluSphere(heelWear, 0.5, 12, 12);
    gluDeleteQuadric(heelWear);
    glPopMatrix();
    
    glDisable(GL_BLEND);
}

// Function to draw traditional pull tab with branding
void drawBrandedPullTab() {
    GLfloat tabColor[] = { 0.4f, 0.25f, 0.15f, 1.0f };
    glColor3fv(tabColor);
    
    glPushMatrix();
    glTranslatef(0.0f, 2.0f, -0.45f);
    glScalef(0.15f, 0.25f, 0.08f);
    GLUquadric* tab = gluNewQuadric();
    gluSphere(tab, 0.5, 12, 12);
    gluDeleteQuadric(tab);
    glPopMatrix();
    
    // Add embossed branding lines
    glDisable(GL_LIGHTING);
    glColor3f(0.5f, 0.3f, 0.2f); // Slightly lighter for embossed effect
    glLineWidth(2.5f);
    
    // Simple brand lines
    glBegin(GL_LINES);
    glVertex3f(-0.05f, 2.05f, -0.42f);
    glVertex3f(0.05f, 2.05f, -0.42f);
    glVertex3f(-0.03f, 1.98f, -0.42f);
    glVertex3f(0.03f, 1.98f, -0.42f);
    glEnd();
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Enhanced traditional decorative stitching with heritage elements
void drawHeritageStitching() {
    glDisable(GL_LIGHTING);
    glLineWidth(2.5f);
    
    // Heritage-style stitching with traditional patterns
    glColor3f(0.85f, 0.75f, 0.55f); // Prominent heritage stitching
    
    // Traditional side panel stitching
    glBegin(GL_LINE_STRIP);
    glVertex3f(-0.45f, -0.1f, 0.5f);
    glVertex3f(-0.5f, 0.1f, 0.2f);
    glVertex3f(-0.45f, 0.3f, -0.1f);
    glVertex3f(-0.4f, 0.5f, -0.3f);
    glVertex3f(-0.35f, 0.8f, -0.4f);
    glEnd();
    
    glBegin(GL_LINE_STRIP);
    glVertex3f(0.45f, -0.1f, 0.5f);
    glVertex3f(0.5f, 0.1f, 0.2f);
    glVertex3f(0.45f, 0.3f, -0.1f);
    glVertex3f(0.4f, 0.5f, -0.3f);
    glVertex3f(0.35f, 0.8f, -0.4f);
    glEnd();
    
    // Central heritage seam
    glBegin(GL_LINE_STRIP);
    glVertex3f(0.0f, 0.3f, 0.6f);
    glVertex3f(0.0f, 0.5f, 0.3f);
    glVertex3f(0.0f, 0.7f, 0.0f);
    glVertex3f(0.0f, 1.0f, -0.2f);
    glVertex3f(0.0f, 1.5f, -0.3f);
    glEnd();
    
    // Heel reinforcement stitching
    glBegin(GL_LINE_LOOP);
    for (int i = 0; i <= 10; i++) {
        float angle = i * PI / 10.0f;
        float x = sinf(angle) * 0.3f;
        float y = 0.2f + cosf(angle) * 0.2f;
        float z = -0.6f;
        glVertex3f(x, y, z);
    }
    glEnd();
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Main function to draw an enhanced heritage combat boot
void drawHeritageCombatBoot(bool isLeft) {
    // Heritage earth-tone colors
    GLfloat soleColor[] = { 0.2f, 0.12f, 0.08f, 1.0f };        // Dark brown sole
    GLfloat leatherColor[] = { 0.5f, 0.35f, 0.22f, 1.0f };     // Rich heritage brown
    GLfloat darkerLeather[] = { 0.4f, 0.25f, 0.16f, 1.0f };    // Darker heritage brown
    GLfloat stitchColor[] = { 0.85f, 0.75f, 0.55f, 1.0f };     // Prominent heritage stitching
    
    glPushMatrix(); // Start of boot matrix

    // Mirror the boot if it's the right one
    if (!isLeft) {
        glScalef(-1.0f, 1.0f, 1.0f);
    }

    // --- Heritage Sole with Welt ---
    glColor3fv(soleColor);
    glPushMatrix();
    glTranslatef(0.0f, -0.8f, 0.1f);
    glScalef(0.8f, 0.12f, 2.4f); // Thicker sole
    GLUquadric* sole = gluNewQuadric();
    gluSphere(sole, 0.5, 20, 20);
    gluDeleteQuadric(sole);
    glPopMatrix();

    // Add traditional sole welt
    drawSoleWelt();

    // Add treaded sole pattern
    drawTreadedSole();

    // --- Enhanced Military Heel ---
    glColor3fv(soleColor);
    glPushMatrix();
    glTranslatef(0.0f, -0.6f, -0.8f);
    glScalef(0.55f, 0.35f, 0.45f);
    GLUquadric* heel = gluNewQuadric();
    gluSphere(heel, 0.5, 12, 12);
    gluDeleteQuadric(heel);
    glPopMatrix();

    // --- Main Foot Body (Enhanced Organic Shape) ---
    glColor3fv(leatherColor);
    glPushMatrix();
    glTranslatef(0.0f, -0.25f, 0.2f);
    drawOrganicFootShape();
    glPopMatrix();

    // --- Add leather grain texture ---
    drawLeatherGrainTexture();

    // --- Classic Reinforced Toe Cap ---
    drawReinforcedToeCap();
    
    // --- Add classic cap toe seam ---
    drawCapToeSeam();

    // --- Enhanced Heritage Boot Shaft ---
    glColor3fv(leatherColor);
    glPushMatrix();
    glTranslatef(0.0f, 0.45f, -0.3f);
    drawCurvedBootShaft(1.9f, 0.52f, 0.44f);
    glPopMatrix();

    // --- Heel Counter Protection ---
    drawHeelCounter();

    // --- Enhanced Ankle Support ---
    drawAnkleSupport();

    // --- Heritage Cuff ---
    glColor3fv(darkerLeather);
    glPushMatrix();
    glTranslatef(0.0f, 2.2f, -0.3f);
    glScalef(0.47f, 0.18f, 0.47f);
    GLUquadric* cuff = gluNewQuadric();
    gluSphere(cuff, 1.0f, 16, 16);
    gluDeleteQuadric(cuff);
    glPopMatrix();

    // --- Branded Pull Tab ---
    drawBrandedPullTab();

    // --- Gusseted Tongue (Waterproof) ---
    glColor3fv(leatherColor);
    glPushMatrix();
    glTranslatef(0.0f, 0.25f, 0.65f);
    glRotatef(-8, 1, 0, 0);
    glScalef(0.32f, 0.06f, 0.85f);
    GLUquadric* tongue = gluNewQuadric();
    gluSphere(tongue, 0.5, 12, 12);
    gluDeleteQuadric(tongue);
    glPopMatrix();

    // --- Enhanced Side Reinforcement Panels ---
    glColor3fv(darkerLeather);
    // Left reinforced panel
    glPushMatrix();
    glTranslatef(-0.37f, 0.35f, 0.0f);
    glScalef(0.12f, 0.9f, 0.65f);
    GLUquadric* leftPanel = gluNewQuadric();
    gluSphere(leftPanel, 0.5, 12, 12);
    gluDeleteQuadric(leftPanel);
    glPopMatrix();
    
    // Right reinforced panel
    glPushMatrix();
    glTranslatef(0.37f, 0.35f, 0.0f);
    glScalef(0.12f, 0.9f, 0.65f);
    GLUquadric* rightPanel = gluNewQuadric();
    gluSphere(rightPanel, 0.5, 12, 12);
    gluDeleteQuadric(rightPanel);
    glPopMatrix();

    // --- Ventilation Grommets ---
    drawVentilationGrommets();

    // --- Add brogue detailing ---
    drawBrogueDetailing();

    // --- Enhanced Heritage Stitching ---
    glColor3fv(stitchColor);
    drawHeritageStitching();
    
    // --- Add double/triple stitching ---
    drawDoubleTripleStitching();

    // --- Heritage Boot Lacing System ---
    glColor3fv(darkerLeather);
    
    // Regular eyelets with reinforcement rings (bottom section)
    for (int i = 0; i < 5; i++) {
        float y = 0.4f + i * 0.2f;
        
        // Left eyelet
        glPushMatrix();
        glTranslatef(-0.16f, y, 0.42f);
        glScalef(0.035f, 0.035f, 0.035f);
        GLUquadric* eyelet1 = gluNewQuadric();
        gluSphere(eyelet1, 1.0f, 8, 8);
        gluDeleteQuadric(eyelet1);
        glPopMatrix();
        
        // Right eyelet
        glPushMatrix();
        glTranslatef(0.16f, y, 0.42f);
        glScalef(0.035f, 0.035f, 0.035f);
        GLUquadric* eyelet2 = gluNewQuadric();
        gluSphere(eyelet2, 1.0f, 8, 8);
        gluDeleteQuadric(eyelet2);
        glPopMatrix();
    }

    // --- Add eyelet reinforcement rings ---
    drawEyeletRings();

    // --- Speed Hooks (upper section) ---
    drawSpeedHooks();

    // --- Enhanced Heritage Lacing ---
    glDisable(GL_LIGHTING);
    glColor3f(0.3f, 0.2f, 0.12f); // Rich brown heritage lacing
    glLineWidth(4.0f);
    
    // Standard lacing pattern (eyelets)
    for (int i = 0; i < 4; i++) {
        float y1 = 0.4f + i * 0.2f;
        float y2 = 0.4f + (i + 1) * 0.2f;
        
        glBegin(GL_LINES);
        glVertex3f(-0.16f, y1, 0.43f);
        glVertex3f(0.16f, y2, 0.43f);
        glVertex3f(0.16f, y1, 0.43f);
        glVertex3f(-0.16f, y2, 0.43f);
        glEnd();
    }
    
    // Speed hook lacing pattern
    for (int i = 0; i < 2; i++) {
        float y1 = 1.4f + i * 0.2f;
        float y2 = 1.4f + (i + 1) * 0.2f;
        
        glBegin(GL_LINES);
        glVertex3f(-0.18f, y1, 0.36f);
        glVertex3f(0.18f, y2, 0.36f);
        glVertex3f(0.18f, y1, 0.36f);
        glVertex3f(-0.18f, y2, 0.36f);
        glEnd();
    }
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);

    // --- Add subtle patina effects ---
    drawPatinaEffects();

    glPopMatrix(); // End of boot matrix
}

// Function to draw character leg (thigh to ankle)
void drawCharacterLeg() {
    GLfloat skinColor[] = { 0.9f, 0.75f, 0.6f, 1.0f }; // Natural skin tone
    glColor3fv(skinColor);
    
    // Upper thigh
    glPushMatrix();
    glTranslatef(0.0f, 6.0f, 0.0f);
    glScalef(0.6f, 1.0f, 0.6f);
    GLUquadric* upperThigh = gluNewQuadric();
    gluSphere(upperThigh, 0.5, 16, 16);
    gluDeleteQuadric(upperThigh);
    glPopMatrix();
    
    // Mid thigh
    glPushMatrix();
    glTranslatef(0.0f, 5.0f, 0.0f);
    glScalef(0.55f, 0.8f, 0.55f);
    GLUquadric* midThigh = gluNewQuadric();
    gluSphere(midThigh, 0.5, 16, 16);
    gluDeleteQuadric(midThigh);
    glPopMatrix();
    
    // Lower thigh (above knee)
    glPushMatrix();
    glTranslatef(0.0f, 4.2f, 0.0f);
    glScalef(0.5f, 0.6f, 0.5f);
    GLUquadric* lowerThigh = gluNewQuadric();
    gluSphere(lowerThigh, 0.5, 16, 16);
    gluDeleteQuadric(lowerThigh);
    glPopMatrix();
    
    // Knee area
    glPushMatrix();
    glTranslatef(0.0f, 3.8f, 0.0f);
    glScalef(0.45f, 0.4f, 0.45f);
    GLUquadric* knee = gluNewQuadric();
    gluSphere(knee, 0.5, 16, 16);
    gluDeleteQuadric(knee);
    glPopMatrix();
    
    // Upper shin
    glPushMatrix();
    glTranslatef(0.0f, 3.2f, 0.0f);
    glScalef(0.4f, 0.6f, 0.4f);
    GLUquadric* upperShin = gluNewQuadric();
    gluSphere(upperShin, 0.5, 16, 16);
    gluDeleteQuadric(upperShin);
    glPopMatrix();
    
    // Lower shin
    glPushMatrix();
    glTranslatef(0.0f, 2.7f, 0.0f);
    glScalef(0.38f, 0.5f, 0.38f);
    GLUquadric* lowerShin = gluNewQuadric();
    gluSphere(lowerShin, 0.5, 16, 16);
    gluDeleteQuadric(lowerShin);
    glPopMatrix();
    
    // Ankle area (where boot starts)
    glPushMatrix();
    glTranslatef(0.0f, 2.3f, 0.0f);
    glScalef(0.35f, 0.3f, 0.35f);
    GLUquadric* ankle = gluNewQuadric();
    gluSphere(ankle, 0.5, 16, 16);
    gluDeleteQuadric(ankle);
    glPopMatrix();
}

// Function to draw traditional pants fabric texture
void drawPantsFabricTexture(float legHeight) {
    glDisable(GL_LIGHTING);
    glPointSize(0.8f);
    glColor3f(0.15f, 0.12f, 0.1f); // Darker texture points
    
    glBegin(GL_POINTS);
    
    // Add fabric texture points across the pants surface
    for (int i = 0; i < 100; i++) {
        float x = ((i * 7) % 60 - 30) * 0.01f;
        float y = 2.5f + ((i * 11) % (int)(legHeight * 50)) * 0.01f;
        float z = ((i * 13) % 60 - 30) * 0.01f;
        
        // Only draw on pants surface
        if (x*x + z*z < 0.3f && y >= 2.5f && y <= 2.5f + legHeight) {
            glVertex3f(x, y, z);
        }
    }
    
    glEnd();
    glPointSize(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw traditional pants seams and stitching
void drawPantsSeams(float legHeight) {
    glDisable(GL_LIGHTING);
    glColor3f(0.4f, 0.35f, 0.25f); // Tan thread color
    glLineWidth(2.0f);
    
    // Outer seam
    glBegin(GL_LINE_STRIP);
    for (int i = 0; i <= 10; i++) {
        float y = 2.5f + (i * legHeight / 10.0f);
        glVertex3f(0.5f, y, 0.0f);
    }
    glEnd();
    
    // Inner seam
    glBegin(GL_LINE_STRIP);
    for (int i = 0; i <= 10; i++) {
        float y = 2.5f + (i * legHeight / 10.0f);
        glVertex3f(-0.5f, y, 0.0f);
    }
    glEnd();
    
    // Front center crease
    glBegin(GL_LINE_STRIP);
    for (int i = 0; i <= 10; i++) {
        float y = 2.5f + (i * legHeight / 10.0f);
        glVertex3f(0.0f, y, 0.45f);
    }
    glEnd();
    
    // Back center seam
    glBegin(GL_LINE_STRIP);
    for (int i = 0; i <= 10; i++) {
        float y = 2.5f + (i * legHeight / 10.0f);
        glVertex3f(0.0f, y, -0.45f);
    }
    glEnd();
    
    // Horizontal stitching lines (for reinforcement)
    for (int j = 1; j < 10; j++) {
        float y = 2.5f + (j * legHeight / 10.0f);
        glBegin(GL_LINE_LOOP);
        for (int i = 0; i <= 20; i++) {
            float angle = i * 2.0f * PI / 20.0f;
            float x = cosf(angle) * 0.48f;
            float z = sinf(angle) * 0.48f;
            glVertex3f(x, y, z);
        }
        glEnd();
    }
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw traditional pants leg
void drawTraditionalPants(float legHeight) {
    GLfloat pantsColor[] = { 0.25f, 0.2f, 0.15f, 1.0f }; // Dark brown/khaki traditional color
    GLfloat pantsShadow[] = { 0.2f, 0.15f, 0.1f, 1.0f }; // Slightly darker for depth
    
    glColor3fv(pantsColor);
    
    // Main pants leg - tapered cylinder
    int segments = 24;
    float angleStep = 2.0f * PI / segments;
    
    glBegin(GL_TRIANGLE_STRIP);
    for (int i = 0; i <= segments; i++) {
        float angle = i * angleStep;
        float x = cosf(angle);
        float z = sinf(angle);
        
        // Bottom (ankle) - narrower
        float bottomRadius = 0.32f;
        glNormal3f(x, 0, z);
        glVertex3f(x * bottomRadius, 2.5f, z * bottomRadius);
        
        // Top (waist area) - wider
        float topRadius = 0.55f;
        glNormal3f(x, 0, z);
        glVertex3f(x * topRadius, 2.5f + legHeight, z * topRadius);
    }
    glEnd();
    
    // Add waistband
    glColor3fv(pantsShadow);
    glPushMatrix();
    glTranslatef(0.0f, 2.5f + legHeight, 0.0f);
    glRotatef(90, 1, 0, 0);
    glScalef(0.57f, 0.57f, 0.08f);
    GLUquadric* waistband = gluNewQuadric();
    gluCylinder(waistband, 1.0f, 1.0f, 1.0f, segments, 1);
    gluDeleteQuadric(waistband);
    glPopMatrix();
    
    // Add belt loops
    glColor3fv(pantsShadow);
    for (int i = 0; i < 6; i++) {
        float angle = i * 2.0f * PI / 6.0f;
        float x = cosf(angle) * 0.57f;
        float z = sinf(angle) * 0.57f;
        
        glPushMatrix();
        glTranslatef(x, 2.5f + legHeight + 0.05f, z);
        glScalef(0.03f, 0.12f, 0.03f);
        GLUquadric* beltLoop = gluNewQuadric();
        gluSphere(beltLoop, 1.0f, 8, 8);
        gluDeleteQuadric(beltLoop);
        glPopMatrix();
    }
    
    // Add fabric texture
    drawPantsFabricTexture(legHeight);
    
    // Add seams and stitching
    drawPantsSeams(legHeight);
}

// Function to draw character waist/pelvis area
void drawCharacterWaist() {
    GLfloat skinColor[] = { 0.9f, 0.75f, 0.6f, 1.0f };
    glColor3fv(skinColor);
    
    // Hip area
    glPushMatrix();
    glTranslatef(0.0f, 6.8f, 0.0f);
    glScalef(0.8f, 0.6f, 0.5f);
    GLUquadric* hip = gluNewQuadric();
    gluSphere(hip, 0.5, 16, 16);
    gluDeleteQuadric(hip);
    glPopMatrix();
}

// Function to draw complete character lower body
void drawCharacterLowerBody(bool isLeft) {
    glPushMatrix(); // Start character matrix
    
    // Mirror for right leg
    if (!isLeft) {
        glScalef(-1.0f, 1.0f, 1.0f);
    }
    
    // Draw the leg (skin)
    drawCharacterLeg();
    
    // Draw traditional pants over the leg
    drawTraditionalPants(4.0f); // 4.0f is the height from ankle to waist
    
    glPopMatrix(); // End character matrix
}

// Function to draw knee armor plate with rivets
void drawKneeArmorPlate() {
    GLfloat armorColor[] = { 0.35f, 0.35f, 0.38f, 1.0f }; // Steel gray for armor
    GLfloat rivetColor[] = { 0.25f, 0.25f, 0.25f, 1.0f }; // Dark metal rivets
    
    // Main knee plate
    glColor3fv(armorColor);
    glPushMatrix();
    glTranslatef(0.0f, 4.0f, 0.18f); // Position at knee, slightly forward
    glScalef(0.32f, 0.22f, 0.1f);
    GLUquadric* kneePlate = gluNewQuadric();
    gluSphere(kneePlate, 1.0, 16, 12);
    gluDeleteQuadric(kneePlate);
    glPopMatrix();
    
    // Armor rivets around knee plate
    glColor3fv(rivetColor);
    for (int i = 0; i < 8; i++) {
        float angle = i * 2.0f * PI / 8.0f;
        float x = sinf(angle) * 0.25f;
        float y = 4.0f + cosf(angle) * 0.15f;
        
        glPushMatrix();
        glTranslatef(x, y, 0.22f);
        glScalef(0.015f, 0.015f, 0.015f);
        GLUquadric* rivet = gluNewQuadric();
        gluSphere(rivet, 1.0f, 8, 8);
        gluDeleteQuadric(rivet);
        glPopMatrix();
    }
}

// Function to draw shin armor plates
void drawShinArmorPlates() {
    GLfloat armorColor[] = { 0.35f, 0.35f, 0.38f, 1.0f }; // Steel gray
    GLfloat rivetColor[] = { 0.25f, 0.25f, 0.25f, 1.0f }; // Dark metal
    
    // Upper shin plate
    glColor3fv(armorColor);
    glPushMatrix();
    glTranslatef(0.0f, 3.6f, 0.16f);
    glScalef(0.26f, 0.18f, 0.08f);
    GLUquadric* upperShin = gluNewQuadric();
    gluSphere(upperShin, 1.0, 16, 12);
    gluDeleteQuadric(upperShin);
    glPopMatrix();
    
    // Lower shin plate
    glPushMatrix();
    glTranslatef(0.0f, 3.1f, 0.14f);
    glScalef(0.24f, 0.16f, 0.07f);
    GLUquadric* lowerShin = gluNewQuadric();
    gluSphere(lowerShin, 1.0, 16, 12);
    gluDeleteQuadric(lowerShin);
    glPopMatrix();
    
    // Add rivets to shin plates
    glColor3fv(rivetColor);
    for (int plate = 0; plate < 2; plate++) {
        float plateY = 3.6f - (plate * 0.5f);
        for (int i = 0; i < 6; i++) {
            float angle = (i - 2.5f) * 0.8f;
            float x = sinf(angle) * 0.18f;
            float y = plateY + cosf(angle) * 0.1f;
            
            glPushMatrix();
            glTranslatef(x, y, 0.19f);
            glScalef(0.012f, 0.012f, 0.012f);
            GLUquadric* rivet = gluNewQuadric();
            gluSphere(rivet, 1.0f, 6, 6);
            gluDeleteQuadric(rivet);
            glPopMatrix();
        }
    }
}

// Function to draw armored straps and buckles
void drawArmoredStraps() {
    GLfloat strapColor[] = { 0.15f, 0.1f, 0.08f, 1.0f };  // Dark leather straps
    GLfloat buckleColor[] = { 0.4f, 0.4f, 0.42f, 1.0f }; // Metal buckles
    
    // Horizontal straps above boots (to show they secure pants above boots)
    for (int j = 0; j < 3; j++) {
        float y = 3.0f + j * 0.1f; // Above boot area
        
        // Main strap
        glColor3fv(strapColor);
        glPushMatrix();
        glTranslatef(0.0f, y, 0.0f);
        glRotatef(90, 1, 0, 0);
        glScalef(0.28f, 0.28f, 0.025f);
        GLUquadric* strap = gluNewQuadric();
        gluCylinder(strap, 1.0, 1.0, 1.0, 20, 1);
        gluDeleteQuadric(strap);
        glPopMatrix();
        
        // Buckle
        glColor3fv(buckleColor);
        glPushMatrix();
        glTranslatef(0.22f, y, 0.0f);
        glScalef(0.04f, 0.025f, 0.02f);
        GLUquadric* buckle = gluNewQuadric();
        gluSphere(buckle, 1.0f, 8, 8);
        gluDeleteQuadric(buckle);
        glPopMatrix();
    }
    
    // Vertical reinforcement straps
    glColor3fv(strapColor);
    for (int side = -1; side <= 1; side += 2) {
        glPushMatrix();
        glTranslatef(side * 0.24f, 3.5f, 0.0f);
        glScalef(0.025f, 0.8f, 0.025f);
        GLUquadric* vertStrap = gluNewQuadric();
        gluSphere(vertStrap, 1.0f, 8, 8);
        gluDeleteQuadric(vertStrap);
        glPopMatrix();
    }
}

// Function to draw enhanced armored pants seams
void drawArmoredPantsSeams(float pantsHeight) {
    glDisable(GL_LIGHTING);
    glColor3f(0.5f, 0.4f, 0.3f); // Reinforced tan thread
    glLineWidth(2.5f);
    
    // Heavy-duty outer seams with double stitching
    for (int row = 0; row < 2; row++) {
        float offset = (row - 0.5f) * 0.015f;
        
        // Outer seam
        glBegin(GL_LINE_STRIP);
        for (int i = 0; i <= 8; i++) {
            float y = 3.0f + (i * pantsHeight / 8.0f);
            glVertex3f(0.26f + offset, y, 0.0f);
        }
        glEnd();
        
        // Inner seam
        glBegin(GL_LINE_STRIP);
        for (int i = 0; i <= 8; i++) {
            float y = 3.0f + (i * pantsHeight / 8.0f);
            glVertex3f(-0.26f + offset, y, 0.0f);
        }
        glEnd();
    }
    
    // Armor attachment seams
    glColor3f(0.6f, 0.5f, 0.4f);
    glLineWidth(3.0f);
    
    // Knee armor attachment stitching
    glBegin(GL_LINE_LOOP);
    for (int i = 0; i <= 12; i++) {
        float angle = i * 2.0f * PI / 12.0f;
        float x = sinf(angle) * 0.34f;
        float y = 4.0f + cosf(angle) * 0.24f;
        glVertex3f(x, y, 0.19f);
    }
    glEnd();
    
    // Shin armor attachment stitching
    for (int plate = 0; plate < 2; plate++) {
        float plateY = 3.6f - (plate * 0.5f);
        glBegin(GL_LINE_LOOP);
        for (int i = 0; i <= 10; i++) {
            float angle = (i - 5) * 0.15f;
            float x = sinf(angle) * 0.28f;
            float y = plateY + cosf(angle) * 0.2f;
            glVertex3f(x, y, 0.17f);
        }
        glEnd();
    }
    
    glLineWidth(1.0f);
    glEnable(GL_LIGHTING);
}

// Function to draw armored pants fabric with reinforcement patches
void drawArmoredFabricTexture(float pantsHeight) {
    glDisable(GL_LIGHTING);
    glPointSize(0.9f);
    glColor3f(0.18f, 0.15f, 0.12f); // Darker, more rugged texture
    
    glBegin(GL_POINTS);
    
    // Dense fabric texture for heavy-duty material
    for (int i = 0; i < 120; i++) {
        float x = ((i * 7) % 50 - 25) * 0.01f;
        float y = 3.0f + ((i * 11) % (int)(pantsHeight * 60)) * 0.01f;
        float z = ((i * 13) % 50 - 25) * 0.01f;
        
        // Only draw on pants surface, avoid armor areas
        if (x*x + z*z < 0.25f && y >= 3.0f && y <= 3.0f + pantsHeight) {
            // Skip armor plate areas
            if (!((y > 3.9f && y < 4.1f) || (y > 3.5f && y < 3.7f) || (y > 3.0f && y < 3.2f))) {
                glVertex3f(x, y, z);
            }
        }
    }
    
    glEnd();
    
    // Add reinforcement patch patterns
    glColor3f(0.12f, 0.1f, 0.08f);
    glBegin(GL_POINTS);
    
    // Knee reinforcement area
    for (int i = 0; i < 30; i++) {
        float angle = (i * 13) % 360 * PI / 180.0f;
        float radius = 0.15f + ((i * 7) % 10) * 0.01f;
        float x = sinf(angle) * radius;
        float y = 4.0f + cosf(angle) * 0.1f;
        glVertex3f(x, y, 0.13f);
    }
    
    glEnd();
    glPointSize(1.0f);
    glEnable(GL_LIGHTING);
}

// Enhanced function to draw armored combat pants
void drawArmoredCombatPants(float legHeight) {
    // Armored pants colors
    GLfloat pantsColor[] = { 0.22f, 0.18f, 0.14f, 1.0f }; // Dark tactical fabric
    GLfloat reinforcementColor[] = { 0.18f, 0.15f, 0.12f, 1.0f }; // Darker reinforcement
    GLfloat armorColor[] = { 0.35f, 0.35f, 0.38f, 1.0f }; // Steel gray armor
    
    // Shortened pants height - end above boots to show boot details
    float pantsBottom = 3.0f; // Start above ankle, well above boot top
    float pantsTop = 3.0f + legHeight;
    
    // Draw main armored pants (shortened and more tapered)
    int segments = 24;
    float angleStep = 2.0f * PI / segments;
    glColor3fv(pantsColor);
    
    glBegin(GL_TRIANGLE_STRIP);
    for (int i = 0; i <= segments; i++) {
        float angle = i * angleStep;
        float x = cosf(angle);
        float z = sinf(angle);
        
        // Bottom (calf) - much tighter to show boot shaft
        float bottomRadius = 0.26f; // Tighter at calf
        glNormal3f(x, 0, z);
        glVertex3f(x * bottomRadius, pantsBottom, z * bottomRadius);
        
        // Top (waist area) - wider
        float topRadius = 0.55f;
        glNormal3f(x, 0, z);
        glVertex3f(x * topRadius, pantsTop, z * topRadius);
    }
    glEnd();
    
    // Draw knee armor plate
    drawKneeArmorPlate();
    
    // Draw shin armor plates
    drawShinArmorPlates();
    
    // Draw reinforced cuff at bottom (interface with boots)
    glColor3fv(reinforcementColor);
    glPushMatrix();
    glTranslatef(0.0f, pantsBottom, 0.0f);
    glRotatef(90, 1, 0, 0);
    glScalef(0.27f, 0.27f, 0.05f);
    GLUquadric* cuff = gluNewQuadric();
    gluCylinder(cuff, 1.0f, 1.0f, 1.0f, segments, 1);
    gluDeleteQuadric(cuff);
    glPopMatrix();
    
    // Draw armored straps and buckles
    drawArmoredStraps();
    
    // Add waistband with tactical elements
    glColor3fv(reinforcementColor);
    glPushMatrix();
    glTranslatef(0.0f, pantsTop, 0.0f);
    glRotatef(90, 1, 0, 0);
    glScalef(0.57f, 0.57f, 0.1f);
    GLUquadric* waistband = gluNewQuadric();
    gluCylinder(waistband, 1.0f, 1.0f, 1.0f, segments, 1);
    gluDeleteQuadric(waistband);
    glPopMatrix();
    
    // Add tactical belt loops with reinforcement
    for (int i = 0; i < 8; i++) {
        float angle = i * 2.0f * PI / 8.0f;
        float x = cosf(angle) * 0.57f;
        float z = sinf(angle) * 0.57f;
        
        glPushMatrix();
        glTranslatef(x, pantsTop + 0.05f, z);
        glScalef(0.035f, 0.15f, 0.035f);
        GLUquadric* beltLoop = gluNewQuadric();
        gluSphere(beltLoop, 1.0f, 8, 8);
        gluDeleteQuadric(beltLoop);
        glPopMatrix();
    }
    
    // Add cargo pocket reinforcement
    glColor3fv(armorColor);
    glPushMatrix();
    glTranslatef(0.35f, 4.5f, 0.1f);
    glScalef(0.15f, 0.25f, 0.05f);
    GLUquadric* cargoPocket = gluNewQuadric();
    gluSphere(cargoPocket, 1.0f, 12, 12);
    gluDeleteQuadric(cargoPocket);
    glPopMatrix();
    
    // Add armored fabric texture
    drawArmoredFabricTexture(legHeight - (pantsBottom - 3.0f));
    
    // Add enhanced seams and stitching
    drawArmoredPantsSeams(legHeight - (pantsBottom - 3.0f));
}

// Enhanced function to draw complete armored character lower body
void drawArmoredCharacterLowerBody(bool isLeft) {
    glPushMatrix(); // Start character matrix
    
    // Mirror for right leg
    if (!isLeft) {
        glScalef(-1.0f, 1.0f, 1.0f);
    }
    
    // Draw the leg (skin) - only visible parts above pants
    GLfloat skinColor[] = { 0.9f, 0.75f, 0.6f, 1.0f };
    glColor3fv(skinColor);
    
    // Only draw upper leg parts (thigh area above pants)
    // Upper thigh
    glPushMatrix();
    glTranslatef(0.0f, 6.0f, 0.0f);
    glScalef(0.6f, 1.0f, 0.6f);
    GLUquadric* upperThigh = gluNewQuadric();
    gluSphere(upperThigh, 0.5, 16, 16);
    gluDeleteQuadric(upperThigh);
    glPopMatrix();
    
    // Mid thigh (partially covered by pants)
    glPushMatrix();
    glTranslatef(0.0f, 5.0f, 0.0f);
    glScalef(0.55f, 0.8f, 0.55f);
    GLUquadric* midThigh = gluNewQuadric();
    gluSphere(midThigh, 0.5, 16, 16);
    gluDeleteQuadric(midThigh);
    glPopMatrix();
    
    // Draw armored combat pants (shortened to show boots)
    drawArmoredCombatPants(3.5f); // Reduced height to end well above boots
    
    glPopMatrix(); // End character matrix
}

// --- APPLICATION FRAMEWORK (No changes needed below this line) ---

void setupLighting() {
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    glEnable(GL_COLOR_MATERIAL);

    GLfloat lightPos0[] = { 4.0f, 5.0f, 6.0f, 1.0f };
    GLfloat lightAmbient0[] = { 0.3f, 0.25f, 0.2f, 1.0f };   // Warmer ambient for heritage look
    GLfloat lightDiffuse0[] = { 0.95f, 0.9f, 0.8f, 1.0f };   // Bright natural light
    GLfloat lightSpecular0[] = { 0.4f, 0.35f, 0.25f, 1.0f }; // Soft specular for leather

    glLightfv(GL_LIGHT0, GL_POSITION, lightPos0);
    glLightfv(GL_LIGHT0, GL_AMBIENT, lightAmbient0);
    glLightfv(GL_LIGHT0, GL_DIFFUSE, lightDiffuse0);
    glLightfv(GL_LIGHT0, GL_SPECULAR, lightSpecular0);

    GLfloat matShininess[] = { 12.0f }; // Lower shininess for authentic leather
    glMaterialfv(GL_FRONT_AND_BACK, GL_SHININESS, matShininess);

    glEnable(GL_NORMALIZE);
    glColorMaterial(GL_FRONT_AND_BACK, GL_AMBIENT_AND_DIFFUSE);
}

LRESULT WINAPI WindowProcedure(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam) {
    switch (msg) {
    case WM_DESTROY:
        PostQuitMessage(0);
        break;

    case WM_KEYDOWN:
        switch (wParam) {
        case VK_ESCAPE: PostQuitMessage(0); break;
        case VK_LEFT:   rotationY -= 5.0f; break;
        case VK_RIGHT:  rotationY += 5.0f; break;
        case VK_UP:     rotationX -= 5.0f; break;
        case VK_DOWN:   rotationX += 5.0f; break;
        case 'W':       zoom += 0.5f; break;
        case 'S':       zoom -= 0.5f; break;
        }
        break;

    default:
        break;
    }
    return DefWindowProc(hWnd, msg, wParam, lParam);
}

bool initPixelFormat(HDC hdc) {
    PIXELFORMATDESCRIPTOR pfd;
    ZeroMemory(&pfd, sizeof(PIXELFORMATDESCRIPTOR));
    pfd.nSize = sizeof(PIXELFORMATDESCRIPTOR);
    pfd.nVersion = 1;
    pfd.dwFlags = PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER;
    pfd.iPixelType = PFD_TYPE_RGBA;
    pfd.cColorBits = 32;
    pfd.cDepthBits = 24;
    pfd.cStencilBits = 0;
    pfd.iLayerType = PFD_MAIN_PLANE;
    int n = ChoosePixelFormat(hdc, &pfd);
    return SetPixelFormat(hdc, n, &pfd);
}

void display() {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();

    // Camera setup - adjusted to show the full character
    glTranslatef(0.0f, -3.5f, zoom);
    glRotatef(rotationX, 1.0f, 0.0f, 0.0f);
    glRotatef(rotationY, 0.0f, 1.0f, 0.0f);

    // Draw character waist (connects both legs)
    drawCharacterWaist();

    // Draw left leg with pants and heritage combat boot
    glPushMatrix();
    glTranslatef(-0.6f, 0.0f, 0.0f); // Position left leg
    drawCharacterLowerBody(true);
    
    // Position and draw left heritage combat boot
    glPushMatrix();
    glTranslatef(0.0f, 2.3f, 0.0f); // Position at ankle level
    glScalef(0.8f, 0.8f, 0.8f); // Scale boot to fit character
    drawHeritageCombatBoot(true);
    glPopMatrix();
    glPopMatrix();

    // Draw right leg with pants and heritage combat boot
    glPushMatrix();
    glTranslatef(0.6f, 0.0f, 0.0f); // Position right leg
    drawCharacterLowerBody(false);
    
    // Position and draw right heritage combat boot
    glPushMatrix();
    glTranslatef(0.0f, 2.3f, 0.0f); // Position at ankle level
    glScalef(0.8f, 0.8f, 0.8f); // Scale boot to fit character
    drawHeritageCombatBoot(false);
    glPopMatrix();
    glPopMatrix();
}

int WINAPI WinMain(HINSTANCE hInst, HINSTANCE, LPSTR, int nCmdShow) {
    WNDCLASSEX wc;
    ZeroMemory(&wc, sizeof(WNDCLASSEX));
    wc.cbSize = sizeof(WNDCLASSEX);
    wc.hInstance = GetModuleHandle(NULL);
    wc.lpfnWndProc = WindowProcedure;
    wc.lpszClassName = WINDOW_TITLE;
    wc.style = CS_HREDRAW | CS_VREDRAW;
    if (!RegisterClassEx(&wc)) return false;

    HWND hWnd = CreateWindow(WINDOW_TITLE, WINDOW_TITLE, WS_OVERLAPPEDWINDOW,
        CW_USEDEFAULT, CW_USEDEFAULT, 1024, 768,
        NULL, NULL, wc.hInstance, NULL);

    HDC hdc = GetDC(hWnd);
    initPixelFormat(hdc);
    HGLRC hglrc = wglCreateContext(hdc);
    if (!wglMakeCurrent(hdc, hglrc)) return false;

    ShowWindow(hWnd, nCmdShow);

    // Initialize OpenGL
    glEnable(GL_DEPTH_TEST);
    setupLighting();
    glMatrixMode(GL_PROJECTION);
    gluPerspective(45.0f, 1024.0f / 768.0f, 0.1f, 100.0f);
    glMatrixMode(GL_MODELVIEW);
    glClearColor(0.2f, 0.15f, 0.15f, 1.0f); // Dark brown background

    MSG msg;
    ZeroMemory(&msg, sizeof(msg));

    while (true) {
        if (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE)) {
            if (msg.message == WM_QUIT) break;
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }
        display();
        SwapBuffers(hdc);
    }

    wglMakeCurrent(NULL, NULL);
    wglDeleteContext(hglrc);
    ReleaseDC(hWnd, hdc);
    UnregisterClass(WINDOW_TITLE, wc.hInstance);

    return (int)msg.wParam;
}